<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Carta de San Valent√≠n</title>

<!-- FUENTES -->
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:wght@500;600&family=Poppins:wght@300;400&display=swap" rel="stylesheet">

<style>
body {
    margin: 0;
    height: 100vh;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    background: linear-gradient(135deg, #000000, #0fb9b1);
    font-family: 'Poppins', sans-serif;
}

/* üåπ P√âTALOS */
.petal {
    position: absolute;
    top: -50px;
    font-size: 20px;
    animation: fall linear infinite;
}
@keyframes fall {
    to {
        transform: translateY(110vh) rotate(360deg);
        opacity: 0;
    }
}

/* CARTA */
.card-container {
    perspective: 1200px;
    z-index: 2;
}
.card {
    width: 360px;
    height: 470px;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 1.2s;
    cursor: pointer;
}
.card.flipped {
    transform: rotateY(180deg);
}
.card-side {
    position: absolute;
    inset: 0;
    border-radius: 20px;
    backface-visibility: hidden;
    box-shadow: 0 15px 35px rgba(0,0,0,0.4);
    padding: 25px;
    box-sizing: border-box;
}

/* FRENTE */
.front {
    background: #ffffff;
    border: 4px solid #e63946;
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
}
.front h2 {
    color: #e63946;
}
.editable {
    border: 2px dashed #0fb9b1;
    padding: 12px;
    border-radius: 12px;
    font-size: 15px;
}

/* ATR√ÅS */
.back {
    transform: rotateY(180deg);
    background: linear-gradient(135deg, #e63946, #0fb9b1);
    color: white;
    text-align: center;
    position: relative;
}

/* ‚ú® NOMBRE */
.glow-name-wrapper {
    position: relative;
    margin-top: 25px;
    height: 50px; /* espacio reservado para nombre */
}
.glow-name {
    font-family: 'Playfair Display', serif;
    font-size: 34px;
    font-weight: 600;
    letter-spacing: 1px;
    animation: glow 2s infinite alternate;
    z-index: 2;
    position: relative;
    opacity: 0; /* empieza invisible */
}
@keyframes glow {
    from { text-shadow: 0 0 6px #fff, 0 0 12px #0fb9b1; }
    to { text-shadow: 0 0 14px #fff, 0 0 28px #e63946; }
}

/* üåü ESTRELLAS */
.star {
    position: absolute;
    font-size: 10px;
    opacity: 0;
    animation: sparkle 2.5s infinite;
    pointer-events: none;
}
@keyframes sparkle {
    0% { opacity: 0; transform: scale(0.5); }
    50% { opacity: 1; transform: scale(1.2); }
    100% { opacity: 0; transform: scale(0.5); }
}

/* TEXTO */
.question {
    font-family: 'Great Vibes', cursive;
    font-size: 34px;
    margin-top: 20px;
    min-height: 120px;
}

/* RASCAR */
.scratch-layer {
    position: absolute;
    inset: 0;
    background: #c0c0c0;
    border-radius: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 22px;
    font-weight: bold;
    color: #000;
}
canvas {
    position: absolute;
    inset: 0;
    border-radius: 20px;
}

/* BOTONES */
.buttons {
    display: none;
    gap: 15px;
    margin-top: 10px;
    justify-content: center;
}
button {
    background: white;
    color: #e63946;
    border: none;
    padding: 10px 18px;
    border-radius: 20px;
    cursor: pointer;
}

/* MENSAJE FINAL */
.final-message {
    display: none;
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.9);
    border-radius: 20px;
    color: white;
    padding: 25px;
    text-align: center;
    justify-content: center;
    align-items: center;
    flex-direction: column;
}
.final-message.active {
    display: flex;
}
.final-message .heart {
    font-size: 90px;
    animation: latido 1.2s infinite;
}
@keyframes latido {
    50% { transform: scale(1.3); }
}
</style>
</head>

<body>

<!-- üéµ M√öSICA -->
<audio id="music" loop>
  <source src="https://cdn.pixabay.com/audio/2022/10/26/audio_9e20a0fddf.mp3" type="audio/mpeg">
</audio>

<!-- üåπ P√âTALOS -->
<script>
setInterval(() => {
    const petal = document.createElement("div");
    petal.className = "petal";
    petal.innerHTML = "üåπ";
    petal.style.left = Math.random() * window.innerWidth + "px";
    petal.style.animationDuration = (3 + Math.random() * 3) + "s";
    document.body.appendChild(petal);
    setTimeout(() => petal.remove(), 6000);
}, 300);
</script>

<div class="card-container">
<div class="card" id="card">

<!-- FRENTE -->
<div class="card-side front">
    <h2>Para ti, mi amor ‚ù§Ô∏è</h2>
    <div class="editable" contenteditable="true">
        Desde que llegaste a mi vida todo es m√°s bonito.
        Cada momento contigo es un regalo que guardo en mi coraz√≥n.
        Esta carta tiene una pregunta importante para ti mi amor.
    </div>
    <p style="margin-top:15px;font-size:13px;">Toca la carta üíï</p>
</div>

<!-- ATR√ÅS -->
<div class="card-side back">

    <div class="glow-name-wrapper" id="nameWrapper">
        <div class="glow-name" id="name"></div>
    </div>

    <div class="question" id="question"></div>

    <div class="buttons" id="buttons">
        <button onclick="showLove(event)">S√≠ üíñ</button>
        <button onclick="showLove(event)">Obvio que s√≠ üòç</button>
    </div>

    <div class="scratch-layer" id="scratchLayer">
        Rasca aqu√≠ üíï
        <canvas id="scratchCanvas"></canvas>
    </div>

    <div class="final-message" id="finalMessage">
        <div class="heart">‚ù§Ô∏è</div>
        <p>
            Eres para siempre mi amor y mi vida entera
            porque el amor que tu me das es tan magico, unico y maravilloso.<br><br>
            <strong>Te amo infinitamente mi amor, mi pulguita bella, mi vida</strong>
        </p>
    </div>

</div>
</div>
</div>

<script>
const nombre = "MI ESPOSITA LILY";
const textoPregunta = "¬øQuieres ser mi San Valent√≠n este 14 de febrero?";

const nameEl = document.getElementById("name");
const wrapper = document.getElementById("nameWrapper");
const questionEl = document.getElementById("question");
const card = document.getElementById("card");
const canvas = document.getElementById("scratchCanvas");
const ctx = canvas.getContext("2d");
const buttons = document.getElementById("buttons");
const scratchLayer = document.getElementById("scratchLayer");
const finalMessage = document.getElementById("finalMessage");
const music = document.getElementById("music");

nameEl.innerText = nombre;

canvas.width = 360;
canvas.height = 470;
ctx.fillStyle = "#c0c0c0";
ctx.fillRect(0, 0, canvas.width, canvas.height);
ctx.globalCompositeOperation = "destination-out";

let scratched = 0;
let writingStarted = false;

card.addEventListener("click", () => {
    if (!card.classList.contains("flipped")) {
        card.classList.add("flipped");
        music.volume = 0.3;
        music.play();
    }
});

function scratch(e) {
    e.preventDefault();
    const rect = canvas.getBoundingClientRect();
    const x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
    const y = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;

    ctx.beginPath();
    ctx.arc(x, y, 20, 0, Math.PI * 2);
    ctx.fill();

    scratched++;
    if (scratched > 160 && !writingStarted) {
        scratchLayer.style.display = "none";
        showNameAndQuestion();
        writingStarted = true;
    }
}

canvas.addEventListener("mousemove", scratch);
canvas.addEventListener("touchmove", scratch);

function showNameAndQuestion() {
    nameEl.style.opacity = 1;

    // Estrellas interactivas alrededor del nombre
    for (let i = 0; i < 12; i++) {
        const star = document.createElement("div");
        star.className = "star";
        star.innerHTML = "‚ú®";
        star.style.left = Math.random() * 100 + "%";
        star.style.top = Math.random() * 100 + "%";
        star.style.animationDelay = Math.random() * 3 + "s";
        wrapper.appendChild(star);
    }

    // Pregunta letra por letra
    let i = 0;
    const interval = setInterval(() => {
        questionEl.innerHTML += textoPregunta.charAt(i);
        i++;
        if (i >= textoPregunta.length) {
            clearInterval(interval);
            buttons.style.display = "flex";
        }
    }, 70);
}

function createStar(x, y) {
    const star = document.createElement("div");
    star.className = "star";
    star.innerHTML = "‚ú®";
    star.style.left = x + "px";
    star.style.top = y + "px";
    star.style.animationDuration = (1.5 + Math.random()) + "s";
    wrapper.appendChild(star);
    setTimeout(() => star.remove(), 2000);
}

nameEl.addEventListener("mousemove", e => {
    const rect = wrapper.getBoundingClientRect();
    createStar(e.clientX - rect.left, e.clientY - rect.top);
});

function showLove(e) {
    e.stopPropagation();
    finalMessage.classList.add("active");
}
</script>

</body>
</html>
